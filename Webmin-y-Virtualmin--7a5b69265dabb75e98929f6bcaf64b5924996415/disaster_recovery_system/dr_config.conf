# CONFIGURACIÓN DEL SISTEMA DE RECUPERACIÓN DE DESASTRES (DR)
# Sistema Automático de DR para Webmin/Virtualmin

# === CONFIGURACIÓN GENERAL ===
DR_SYSTEM_VERSION="1.0.0"
DR_ROOT_DIR="/opt/disaster_recovery"
LOG_DIR="$DR_ROOT_DIR/logs"
CONFIG_DIR="$DR_ROOT_DIR/config"
TEMP_DIR="$DR_ROOT_DIR/temp"

# === CONFIGURACIÓN DE REPLICACIÓN ===
# Tipos de replicación soportados
REPLICATION_TYPE="real_time"  # real_time | scheduled | hybrid
REPLICATION_METHOD="rsync"    # rsync | drbd | glusterfs | mysql_replication

# Servidores de replicación (pares primario/secundario)
PRIMARY_SERVER="primary.example.com"
SECONDARY_SERVER="secondary.example.com"
REPLICATION_PORT="873"
REPLICATION_USER="dr_sync"

# Directorios a replicar en tiempo real
REALTIME_REPLICATION_DIRS=(
    "/var/www"
    "/var/lib/mysql"
    "/etc/webmin"
    "/etc/virtualmin"
    "/opt/enterprise_backups"
)

# Exclusiones de replicación
REPLICATION_EXCLUDES=(
    "*.log"
    "*.tmp"
    "*/cache/*"
    "*/tmp/*"
    "*/.git/*"
)

# === CONFIGURACIÓN DE FAILOVER ===
# Umbrales de failover
FAILOVER_CPU_THRESHOLD="90"
FAILOVER_MEMORY_THRESHOLD="95"
FAILOVER_DISK_THRESHOLD="95"
FAILOVER_NETWORK_TIMEOUT="30"

# Métodos de failover
FAILOVER_METHOD="automatic"  # automatic | manual | semi_automatic
VIP_ADDRESS="192.168.1.100"
VIP_INTERFACE="eth0"

# Servicios críticos para failover
CRITICAL_SERVICES=(
    "webmin"
    "usermin"
    "apache2"
    "nginx"
    "mysql"
    "postgresql"
    "bind9"
)

# === CONFIGURACIÓN DE RECUPERACIÓN ===
# Objetivos de recuperación (RTO/RPO)
RTO_MINUTES="15"      # Recovery Time Objective
RPO_SECONDS="60"      # Recovery Point Objective

# Estrategias de recuperación
RECOVERY_STRATEGY="automatic"  # automatic | semi_automatic | manual
BACKUP_RESTORE_PRIORITY="critical_first"  # critical_first | parallel | sequential

# === CONFIGURACIÓN DE TESTING ===
# Tipos de pruebas de recuperación
DR_TEST_TYPES=(
    "full_failover_test"
    "partial_failover_test"
    "data_corruption_test"
    "network_failure_test"
    "service_failure_test"
)

# Frecuencia de pruebas
DR_TEST_FREQUENCY="weekly"  # daily | weekly | monthly
DR_TEST_SCHEDULE="sunday 02:00"

# === CONFIGURACIÓN DE REPORTES ===
# Reportes de cumplimiento
COMPLIANCE_REPORTING="enabled"
REPORT_RETENTION_DAYS="365"
REPORT_FORMAT="html,pdf,json"

# Auditoría
AUDIT_LOGGING="enabled"
AUDIT_RETENTION_DAYS="2555"  # 7 años

# Notificaciones
NOTIFICATION_EMAIL="admin@enterprise.local"
NOTIFICATION_WEBHOOK=""
SLACK_WEBHOOK=""

# === CONFIGURACIÓN DE INTEGRACIÓN ===
# Integración con sistemas existentes
INTEGRATE_BACKUP_SYSTEM="true"
INTEGRATE_MONITORING_SYSTEM="true"
INTEGRATE_CLUSTERING_SYSTEM="true"

# Rutas a sistemas existentes
BACKUP_SYSTEM_PATH="/opt/enterprise_backups"
MONITORING_SYSTEM_PATH="/opt/webmin-devops-monitoring"
CLUSTERING_SYSTEM_PATH="/opt/pro_clustering"

# === CONFIGURACIÓN AVANZADA ===
# Encriptación
ENCRYPTION_ENABLED="true"
ENCRYPTION_KEY_FILE="$DR_ROOT_DIR/.dr_key"
ENCRYPTION_ALGORITHM="aes-256-cbc"

# Compresión
COMPRESSION_ENABLED="true"
COMPRESSION_LEVEL="6"
COMPRESSION_TYPE="gzip"

# Monitoreo de salud
HEALTH_CHECK_INTERVAL="30"
HEALTH_CHECK_TIMEOUT="10"
HEALTH_CHECK_RETRIES="3"

# Logging
LOG_LEVEL="info"  # debug | info | warning | error
LOG_ROTATION="daily"
LOG_RETENTION="30"

# === CONFIGURACIÓN DE SEGURIDAD ===
# Autenticación
AUTH_METHOD="certificate"  # password | key | certificate
CERT_PATH="$DR_ROOT_DIR/certs"
CA_CERT="$CERT_PATH/ca.crt"
CLIENT_CERT="$CERT_PATH/client.crt"
CLIENT_KEY="$CERT_PATH/client.key"

# Firewall rules
FIREWALL_MANAGEMENT="auto"
ALLOWED_IPS=("192.168.1.0/24" "10.0.0.0/8")