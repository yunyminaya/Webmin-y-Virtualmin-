# Estrategia de Branching Git para Webmin/Virtualmin DevOps

## Estructura de Ramas

### Ramas Principales
- **`main`** - Rama de producción. Solo contiene código estable y liberado.
- **`develop`** - Rama de desarrollo. Contiene el último código desarrollado para la próxima release.

### Ramas de Soporte
- **`feature/*`** - Ramas para desarrollo de nuevas funcionalidades
  - Ejemplo: `feature/user-authentication`, `feature/ci-cd-pipeline`
- **`release/*`** - Ramas para preparación de releases
  - Ejemplo: `release/v1.2.0`
- **`hotfix/*`** - Ramas para corrección rápida de bugs en producción
  - Ejemplo: `hotfix/security-patch-001`

## Flujo de Trabajo

### Desarrollo de Nuevas Funcionalidades
1. Crear rama desde `develop`: `git checkout -b feature/nueva-funcionalidad`
2. Desarrollar y hacer commits
3. Push a rama feature: `git push origin feature/nueva-funcionalidad`
4. Crear Pull Request hacia `develop`
5. Después del merge, eliminar rama feature

### Preparación de Release
1. Crear rama release desde `develop`: `git checkout -b release/v1.2.0`
2. Realizar ajustes finales y testing
3. Merge a `main` y `develop`
4. Crear tag: `git tag v1.2.0`

### Hotfixes
1. Crear rama desde `main`: `git checkout -b hotfix/critical-bug-fix`
2. Corregir el bug
3. Merge a `main` y `develop`
4. Crear tag si es necesario

## Reglas de Commit

### Formato de Commit Messages
```
tipo(scope): descripción breve

[descripción detallada opcional]

[footer opcional]
```

### Tipos de Commit
- `feat`: Nueva funcionalidad
- `fix`: Corrección de bug
- `docs`: Cambios en documentación
- `style`: Cambios de estilo (formateo, etc.)
- `refactor`: Refactorización de código
- `test`: Agregar o corregir tests
- `chore`: Cambios en herramientas, configuración

### Ejemplos
```
feat(auth): agregar autenticación de dos factores
fix(backup): corregir restauración incremental
docs(readme): actualizar guía de instalación
```

## Protección de Ramas

### Rama `main`
- Requiere revisión de código (Pull Request)
- Requiere que pasen todos los tests CI/CD
- No permite commits directos
- Requiere aprobación de al menos 2 revisores

### Rama `develop`
- Requiere revisión de código
- Requiere que pasen tests básicos
- No permite commits directos

## Integración con CI/CD

### Triggers Automáticos
- Push a `main`: Despliegue a producción
- Push a `develop`: Despliegue a staging
- Pull Request: Ejecutar tests completos
- Tag creation: Crear release automática

### Validaciones Pre-commit
- Verificación de sintaxis
- Tests unitarios
- Linting de código
- Verificación de seguridad básica

### Validaciones Pre-push
- Tests de integración
- Tests funcionales
- Escaneo de seguridad
- Validación de configuración de despliegue

## Gestión de Versiones

### Versionado Semántico
- `MAJOR.MINOR.PATCH`
- `MAJOR`: Cambios incompatibles
- `MINOR`: Nuevas funcionalidades compatibles
- `PATCH`: Correcciones de bugs

### Tags
- Tags en formato `v1.2.3`
- Tags automáticos desde releases
- Tags manuales para hotfixes críticos

## Herramientas de Automatización

### Git Hooks
- `pre-commit`: Validaciones rápidas
- `post-commit`: Notificaciones y actualizaciones
- `pre-push`: Tests completos y validaciones

### Scripts de Automatización
- `scripts/create-feature-branch.sh`: Crear rama feature
- `scripts/create-release-branch.sh`: Crear rama release
- `scripts/merge-release.sh`: Merge release a main/develop
- `scripts/create-hotfix-branch.sh`: Crear rama hotfix

## Monitoreo y Alertas

### Métricas a Monitorear
- Tiempo de construcción de branches
- Tasa de éxito de merges
- Frecuencia de hotfixes
- Cobertura de código por rama

### Alertas
- Fallos en pipelines de CI/CD
- Branches sin actualizar por más de 30 días
- Commits directos a ramas protegidas
- Conflictos de merge frecuentes