<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Seguridad Unificado - Virtualmin Enterprise</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --sidebar-width: 250px;
            --header-height: 60px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            overflow-x: hidden;
        }

        .layout {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary-color);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left-color: var(--secondary-color);
        }

        .menu-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left-color: var(--secondary-color);
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            height: var(--header-height);
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .header-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-left: 15px;
        }

        .header-right {
            display: flex;
            align-items: center;
        }

        .notification-icon {
            position: relative;
            margin-right: 20px;
            font-size: 1.2rem;
            color: var(--dark-color);
            cursor: pointer;
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-profile {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }

        /* Content */
        .content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        /* Cards */
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 25px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .stat-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            display: flex;
            align-items: center;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.green {
            background-color: var(--success-color);
        }

        .stat-icon.blue {
            background-color: var(--secondary-color);
        }

        .stat-icon.orange {
            background-color: var(--warning-color);
        }

        .stat-icon.red {
            background-color: var(--danger-color);
        }

        .stat-text {
            flex: 1;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
        }

        .stat-label {
            color: #777;
            margin-top: 5px;
        }

        /* Security Components */
        .security-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .component-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .component-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .component-title {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .component-title i {
            margin-right: 10px;
            color: var(--secondary-color);
        }

        .component-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
        }

        .status-warning {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning-color);
        }

        .status-inactive {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
        }

        .security-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .security-table th,
        .security-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .security-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
        }

        .security-table tr:hover {
            background-color: #f8f9fa;
        }

        /* Forms */
        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 5px;
        }

        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #229954;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background-color: #d68910;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--success-color);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #eee;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--success-color);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* Alert */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            display: flex;
            align-items: center;
        }

        .alert i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .alert-success {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }

        .alert-warning {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning-color);
            border-left: 4px solid var(--warning-color);
        }

        .alert-danger {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
            border-left: 4px solid var(--danger-color);
        }

        /* Tabs */
        .tabs {
            margin-bottom: 20px;
        }

        .tab-list {
            display: flex;
            border-bottom: 1px solid #ddd;
            list-style-type: none;
            padding: 0;
        }

        .tab-item {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-item:hover {
            background-color: #f8f9fa;
        }

        .tab-item.active {
            border-bottom-color: var(--secondary-color);
            color: var(--secondary-color);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .modal-close {
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
            background: none;
            border: none;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 2px;
            background-color: #eee;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--secondary-color);
        }

        .timeline-content {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 15px;
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .timeline-title {
            font-weight: 600;
            color: var(--dark-color);
        }

        .timeline-time {
            color: #777;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .dashboard-grid,
            .security-components {
                grid-template-columns: 1fr;
            }

            .header-title {
                font-size: 1.2rem;
            }
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: var(--secondary-color);
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* Log Viewer */
        .log-viewer {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 3px 7px;
            font-size: 0.8rem;
            font-weight: 600;
            border-radius: 10px;
            text-transform: uppercase;
        }

        .badge-success {
            background-color: var(--success-color);
            color: white;
        }

        .badge-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .badge-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .badge-info {
            background-color: var(--secondary-color);
            color: white;
        }
    </style>
</head>
<body>
    <div class="layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-shield-alt"></i> Seguridad</h2>
            </div>
            <nav class="sidebar-menu">
                <a href="#overview" class="menu-item active" onclick="showSection('overview')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Resumen</span>
                </a>
                <a href="#firewall" class="menu-item" onclick="showSection('firewall')">
                    <i class="fas fa-fire"></i>
                    <span>Firewall</span>
                </a>
                <a href="#ids-ips" class="menu-item" onclick="showSection('ids-ips')">
                    <i class="fas fa-shield-virus"></i>
                    <span>IDS/IPS</span>
                </a>
                <a href="#ssl" class="menu-item" onclick="showSection('ssl')">
                    <i class="fas fa-lock"></i>
                    <span>Certificados SSL</span>
                </a>
                <a href="#waf" class="menu-item" onclick="showSection('waf')">
                    <i class="fas fa-filter"></i>
                    <span>WAF</span>
                </a>
                <a href="#logs" class="menu-item" onclick="showSection('logs')">
                    <i class="fas fa-file-alt"></i>
                    <span>Logs de Seguridad</span>
                </a>
                <a href="#alerts" class="menu-item" onclick="showSection('alerts')">
                    <i class="fas fa-bell"></i>
                    <span>Alertas</span>
                </a>
                <a href="#settings" class="menu-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Configuración</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="btn btn-sm" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="header-title">Dashboard de Seguridad Unificado</h1>
                </div>
                <div class="header-right">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">A</div>
                        <span>Admin</span>
                    </div>
                </div>
            </header>

            <!-- Content -->
            <div class="content">
                <!-- Overview Section -->
                <section id="overview-section" class="section-content active">
                    <h1 class="page-title">Resumen de Seguridad</h1>
                    
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-icon green">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-text">
                                <div class="stat-value">98%</div>
                                <div class="stat-label">Estado General de Seguridad</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon blue">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="stat-text">
                                <div class="stat-value">247</div>
                                <div class="stat-label">Amenazas Bloqueadas</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon orange">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-text">
                                <div class="stat-value">5</div>
                                <div class="stat-label">Alertas Activas</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon red">
                                <i class="fas fa-bug"></i>
                            </div>
                            <div class="stat-text">
                                <div class="stat-value">12</div>
                                <div class="stat-label">Vulnerabilidades Detectadas</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Componentes de Seguridad</h3>
                            <button class="btn btn-sm btn-primary" onclick="refreshComponents()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        
                        <div class="security-components">
                            <div class="component-card">
                                <div class="component-header">
                                    <div class="component-title">
                                        <i class="fas fa-fire"></i>
                                        Firewall
                                    </div>
                                    <span class="component-status status-active">Activo</span>
                                </div>
                                <p>Reglas activas: 142</p>
                                <p>Conexiones bloqueadas: 3,247</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 95%;"></div>
                                </div>
                                <small>Rendimiento: 95%</small>
                            </div>
                            
                            <div class="component-card">
                                <div class="component-header">
                                    <div class="component-title">
                                        <i class="fas fa-shield-virus"></i>
                                        IDS/IPS
                                    </div>
                                    <span class="component-status status-active">Activo</span>
                                </div>
                                <p>Firmas actualizadas: 2,341</p>
                                <p>Intrusiones prevenidas: 89</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 88%;"></div>
                                </div>
                                <small>Rendimiento: 88%</small>
                            </div>
                            
                            <div class="component-card">
                                <div class="component-header">
                                    <div class="component-title">
                                        <i class="fas fa-lock"></i>
                                        Certificados SSL
                                    </div>
                                    <span class="component-status status-warning">Advertencia</span>
                                </div>
                                <p>Certificados válidos: 8</p>
                                <p>Certificados por expirar: 2</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 75%;"></div>
                                </div>
                                <small>Estado: 75%</small>
                            </div>
                            
                            <div class="component-card">
                                <div class="component-header">
                                    <div class="component-title">
                                        <i class="fas fa-filter"></i>
                                        WAF
                                    </div>
                                    <span class="component-status status-active">Activo</span>
                                </div>
                                <p>Reglas activas: 67</p>
                                <p>Ataques bloqueados: 124</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 92%;"></div>
                                </div>
                                <small>Rendimiento: 92%</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Actividad de Seguridad Reciente</h3>
                        </div>
                        
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-content">
                                    <div class="timeline-header">
                                        <div class="timeline-title">Ataque de fuerza bruta bloqueado</div>
                                        <div class="timeline-time">Hace 15 minutos</div>
                                    </div>
                                    <p>IP: 192.168.1.105 intentó acceder al panel de administración con múltiples credenciales. Bloqueado por el firewall.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-content">
                                    <div class="timeline-header">
                                        <div class="timeline-title">Actualización de firmas IDS/IPS</div>
                                        <div class="timeline-time">Hace 2 horas</div>
                                    </div>
                                    <p>Se actualizaron 34 nuevas firmas de malware y vulnerabilidades.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-content">
                                    <div class="timeline-header">
                                        <div class="timeline-title">Certificado SSL renovado</div>
                                        <div class="timeline-time">Hace 5 horas</div>
                                    </div>
                                    <p>El certificado SSL para virtualmin-enterprise.com fue renovado automáticamente.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-content">
                                    <div class="timeline-header">
                                        <div class="timeline-title">Intento de inyección SQL bloqueado</div>
                                        <div class="timeline-time">Hace 1 día</div>
                                    </div>
                                    <p>El WAF bloqueó un intento de inyección SQL en el formulario de contacto.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Firewall Section -->
                <section id="firewall-section" class="section-content">
                    <h1 class="page-title">Configuración de Firewall</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Estado del Firewall</h3>
                            <div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="firewall-toggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span style="margin-left: 10px;">Activar/Desactivar</span>
                            </div>
                        </div>
                        
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle"></i>
                            El firewall está activo y funcionando correctamente.
                        </div>
                        
                        <div class="table-container">
                            <table class="security-table">
                                <thead>
                                    <tr>
                                        <th>Regla</th>
                                        <th>Acción</th>
                                        <th>Protocolo</th>
                                        <th>Puerto</th>
                                        <th>Origen</th>
                                        <th>Destino</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Permitir SSH</td>
                                        <td>ACCEPT</td>
                                        <td>TCP</td>
                                        <td>22</td>
                                        <td>192.168.1.0/24</td>
                                        <td>ANY</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Permitir HTTP</td>
                                        <td>ACCEPT</td>
                                        <td>TCP</td>
                                        <td>80</td>
                                        <td>ANY</td>
                                        <td>ANY</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Permitir HTTPS</td>
                                        <td>ACCEPT</td>
                                        <td>TCP</td>
                                        <td>443</td>
                                        <td>ANY</td>
                                        <td>ANY</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Bloquear Escaneo de Puertos</td>
                                        <td>DROP</td>
                                        <td>ANY</td>
                                        <td>ANY</td>
                                        <td>ANY</td>
                                        <td>ANY</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="showAddRuleModal()">
                                <i class="fas fa-plus"></i> Añadir Regla
                            </button>
                            <button class="btn btn-success" onclick="importRules()">
                                <i class="fas fa-file-import"></i> Importar Reglas
                            </button>
                            <button class="btn btn-warning" onclick="exportRules()">
                                <i class="fas fa-file-export"></i> Exportar Reglas
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Estadísticas del Firewall</h3>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="firewall-chart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- IDS/IPS Section -->
                <section id="ids-ips-section" class="section-content">
                    <h1 class="page-title">Configuración de IDS/IPS</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Estado de IDS/IPS</h3>
                            <div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="ids-toggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span style="margin-left: 10px;">Activar/Desactivar</span>
                            </div>
                        </div>
                        
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle"></i>
                            El sistema IDS/IPS está activo y funcionando correctamente.
                        </div>
                        
                        <div class="tabs">
                            <ul class="tab-list">
                                <li class="tab-item active" onclick="showTab('ids-signatures')">Firmas</li>
                                <li class="tab-item" onclick="showTab('ids-rules')">Reglas</li>
                                <li class="tab-item" onclick="showTab('ids-events')">Eventos</li>
                            </ul>
                            
                            <div id="ids-signatures" class="tab-content active">
                                <div class="table-container">
                                    <table class="security-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Categoría</th>
                                                <th>Severidad</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>10001</td>
                                                <td>SQL Injection Attempt</td>
                                                <td>Inyección</td>
                                                <td><span class="badge badge-danger">Alta</span></td>
                                                <td><span class="badge badge-success">Activo</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>10002</td>
                                                <td>Cross-Site Scripting (XSS)</td>
                                                <td>XSS</td>
                                                <td><span class="badge badge-warning">Media</span></td>
                                                <td><span class="badge badge-success">Activo</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>10003</td>
                                                <td>Directory Traversal</td>
                                                <td>Acceso</td>
                                                <td><span class="badge badge-danger">Alta</span></td>
                                                <td><span class="badge badge-success">Activo</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" onclick="updateSignatures()">
                                        <i class="fas fa-sync-alt"></i> Actualizar Firmas
                                    </button>
                                    <button class="btn btn-success" onclick="addSignature()">
                                        <i class="fas fa-plus"></i> Añadir Firma
                                    </button>
                                </div>
                            </div>
                            
                            <div id="ids-rules" class="tab-content">
                                <div class="table-container">
                                    <table class="security-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Acción</th>
                                                <th>Protocolo</th>
                                                <th>Puerto</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>20001</td>
                                                <td>Block Port Scanning</td>
                                                <td>BLOCK</td>
                                                <td>TCP</td>
                                                <td>ANY</td>
                                                <td><span class="badge badge-success">Activo</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>20002</td>
                                                <td>Alert on Suspicious Traffic</td>
                                                <td>ALERT</td>
                                                <td>ANY</td>
                                                <td>ANY</td>
                                                <td><span class="badge badge-success">Activo</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" onclick="addRule()">
                                        <i class="fas fa-plus"></i> Añadir Regla
                                    </button>
                                </div>
                            </div>
                            
                            <div id="ids-events" class="tab-content">
                                <div class="table-container">
                                    <table class="security-table">
                                        <thead>
                                            <tr>
                                                <th>Timestamp</th>
                                                <th>ID de Firma</th>
                                                <th>Nombre de Firma</th>
                                                <th>IP Origen</th>
                                                <th>IP Destino</th>
                                                <th>Severidad</th>
                                                <th>Acción</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>2023-10-15 10:23:45</td>
                                                <td>10001</td>
                                                <td>SQL Injection Attempt</td>
                                                <td>192.168.1.105</td>
                                                <td>192.168.1.10</td>
                                                <td><span class="badge badge-danger">Alta</span></td>
                                                <td>Bloqueado</td>
                                            </tr>
                                            <tr>
                                                <td>2023-10-15 09:45:12</td>
                                                <td>10002</td>
                                                <td>Cross-Site Scripting (XSS)</td>
                                                <td>192.168.1.203</td>
                                                <td>192.168.1.10</td>
                                                <td><span class="badge badge-warning">Media</span></td>
                                                <td>Registrado</td>
                                            </tr>
                                            <tr>
                                                <td>2023-10-15 08:32:07</td>
                                                <td>10003</td>
                                                <td>Directory Traversal</td>
                                                <td>192.168.1.187</td>
                                                <td>192.168.1.10</td>
                                                <td><span class="badge badge-danger">Alta</span></td>
                                                <td>Bloqueado</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" onclick="exportEvents()">
                                        <i class="fas fa-file-export"></i> Exportar Eventos
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- SSL Section -->
                <section id="ssl-section" class="section-content">
                    <h1 class="page-title">Gestión de Certificados SSL</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Certificados SSL</h3>
                            <button class="btn btn-sm btn-primary" onclick="refreshCertificates()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="security-table">
                                <thead>
                                    <tr>
                                        <th>Dominio</th>
                                        <th>Emisor</th>
                                        <th>Fecha de Emisión</th>
                                        <th>Fecha de Expiración</th>
                                        <th>Días Restantes</th>
                                        <th>Estado</th>
                                        <th>Auto-Renovación</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>virtualmin-enterprise.com</td>
                                        <td>Let's Encrypt</td>
                                        <td>2023-07-15</td>
                                        <td>2023-10-13</td>
                                        <td><span class="badge badge-danger">2</span></td>
                                        <td><span class="badge badge-danger">Por Expirar</span></td>
                                        <td>
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="renewCertificate('virtualmin-enterprise.com')">
                                                <i class="fas fa-sync"></i> Renovar
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>api.virtualmin-enterprise.com</td>
                                        <td>Let's Encrypt</td>
                                        <td>2023-08-01</td>
                                        <td>2023-11-01</td>
                                        <td><span class="badge badge-warning">17</span></td>
                                        <td><span class="badge badge-warning">Por Expirar</span></td>
                                        <td>
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="renewCertificate('api.virtualmin-enterprise.com')">
                                                <i class="fas fa-sync"></i> Renovar
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>mail.virtualmin-enterprise.com</td>
                                        <td>Let's Encrypt</td>
                                        <td>2023-07-20</td>
                                        <td>2023-10-20</td>
                                        <td><span class="badge badge-success">5</span></td>
                                        <td><span class="badge badge-success">Válido</span></td>
                                        <td>
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-warning" onclick="viewCertificate('mail.virtualmin-enterprise.com')">
                                                <i class="fas fa-eye"></i> Ver
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="requestCertificate()">
                                <i class="fas fa-plus"></i> Solicitar Certificado
                            </button>
                            <button class="btn btn-success" onclick="configureAutoRenewal()">
                                <i class="fas fa-cog"></i> Configurar Auto-Renovación
                            </button>
                        </div>
                    </div>
                </section>

                <!-- WAF Section -->
                <section id="waf-section" class="section-content">
                    <h1 class="page-title">Configuración de WAF</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Estado de WAF</h3>
                            <div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="waf-toggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span style="margin-left: 10px;">Activar/Desactivar</span>
                            </div>
                        </div>
                        
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle"></i>
                            El WAF está activo y funcionando correctamente.
                        </div>
                        
                        <div class="table-container">
                            <table class="security-table">
                                <thead>
                                    <tr>
                                        <th>Regla</th>
                                        <th>ID</th>
                                        <th>Categoría</th>
                                        <th>Severidad</th>
                                        <th>Acción</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Detect SQL Injection</td>
                                        <td>941100</td>
                                        <td>SQL Inyección</td>
                                        <td><span class="badge badge-danger">Alta</span></td>
                                        <td>Bloquear</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Detect Cross-Site Scripting</td>
                                        <td>941160</td>
                                        <td>XSS</td>
                                        <td><span class="badge badge-warning">Media</span></td>
                                        <td>Bloquear</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Detect Remote File Inclusion</td>
                                        <td>941170</td>
                                        <td>RFI</td>
                                        <td><span class="badge badge-danger">Alta</span></td>
                                        <td>Bloquear</td>
                                        <td><span class="badge badge-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                                            <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="updateWafRules()">
                                <i class="fas fa-sync-alt"></i> Actualizar Reglas
                            </button>
                            <button class="btn btn-success" onclick="addWafRule()">
                                <i class="fas fa-plus"></i> Añadir Regla
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Estadísticas de WAF</h3>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="waf-chart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Logs Section -->
                <section id="logs-section" class="section-content">
                    <h1 class="page-title">Logs de Seguridad</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Visor de Logs</h3>
                            <div>
                                <select class="form-control" style="width: 200px; display: inline-block;" id="log-level">
                                    <option value="all">Todos los niveles</option>
                                    <option value="error">Error</option>
                                    <option value="warning">Advertencia</option>
                                    <option value="info">Información</option>
                                </select>
                                <button class="btn btn-sm btn-primary" style="margin-left: 10px;" onclick="refreshLogs()">
                                    <i class="fas fa-sync-alt"></i> Actualizar
                                </button>
                            </div>
                        </div>
                        
                        <div class="log-viewer" id="log-viewer">
                            [2023-10-15 10:23:45] [ERROR] Firewall: IP 192.168.1.105 bloqueada por intento de fuerza bruta
                            [2023-10-15 10:15:32] [WARNING] IDS/IPS: Firma 10001 coincidencia en tráfico desde 192.168.1.203
                            [2023-10-15 10:05:18] [INFO] SSL: Certificado para api.virtualmin-enterprise.com renovado automáticamente
                            [2023-10-15 09:45:12] [WARNING] WAF: Posible ataque XSS detectado en /contacto.php
                            [2023-10-15 09:30:05] [ERROR] IDS/IPS: Firma 10003 coincidencia en tráfico desde 192.168.1.187
                            [2023-10-15 09:15:47] [INFO] Firewall: Regla actualizada para permitir tráfico SSH desde 192.168.1.50
                            [2023-10-15 08:45:23] [ERROR] WAF: Ataque de inyección SQL detectado y bloqueado
                            [2023-10-15 08:30:11] [INFO] SSL: Verificación programada de certificados completada
                            [2023-10-15 08:15:04] [WARNING] IDS/IPS: Firma 10002 coincidencia en tráfico desde 192.168.1.112
                            [2023-10-15 08:00:52] [ERROR] Firewall: IP 192.168.1.98 bloqueada por escaneo de puertos
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="exportLogs()">
                                <i class="fas fa-file-export"></i> Exportar Logs
                            </button>
                            <button class="btn btn-warning" onclick="clearLogs()">
                                <i class="fas fa-trash"></i> Limpiar Logs
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Alerts Section -->
                <section id="alerts-section" class="section-content">
                    <h1 class="page-title">Alertas de Seguridad</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Alertas Activas</h3>
                            <button class="btn btn-sm btn-primary" onclick="refreshAlerts()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="security-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Título</th>
                                        <th>Descripción</th>
                                        <th>Severidad</th>
                                        <th>Fecha</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ALERT-001</td>
                                        <td>Certificado SSL por expirar</td>
                                        <td>El certificado SSL para virtualmin-enterprise.com expirará en 2 días</td>
                                        <td><span class="badge badge-danger">Alta</span></td>
                                        <td>2023-10-13 10:15:00</td>
                                        <td><span class="badge badge-danger">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="resolveAlert('ALERT-001')">
                                                <i class="fas fa-check"></i> Resolver
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>ALERT-002</td>
                                        <td>Múltiples intentos de acceso</td>
                                        <td>Se detectaron 5 intentos fallidos de acceso desde la IP 192.168.1.105</td>
                                        <td><span class="badge badge-warning">Media</span></td>
                                        <td>2023-10-15 09:30:00</td>
                                        <td><span class="badge badge-warning">Investigando</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="resolveAlert('ALERT-002')">
                                                <i class="fas fa-check"></i> Resolver
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>ALERT-003</td>
                                        <td>Actualización de seguridad disponible</td>
                                        <td>Hay una actualización de seguridad crítica para el kernel del sistema</td>
                                        <td><span class="badge badge-info">Baja</span></td>
                                        <td>2023-10-14 14:20:00</td>
                                        <td><span class="badge badge-info">Programado</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" onclick="resolveAlert('ALERT-003')">
                                                <i class="fas fa-check"></i> Resolver
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Configuración de Alertas</h3>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Método de Notificación</label>
                            <select class="form-control" id="notification-method">
                                <option value="email">Correo Electrónico</option>
                                <option value="sms">SMS</option>
                                <option value="webhook">Webhook</option>
                                <option value="slack">Slack</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Destinatario</label>
                            <input type="text" class="form-control" id="notification-recipient" placeholder="admin@virtualmin-enterprise.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Nivel Mínimo de Alerta</label>
                            <select class="form-control" id="alert-level">
                                <option value="low">Bajo</option>
                                <option value="medium">Medio</option>
                                <option value="high">Alto</option>
                                <option value="critical">Crítico</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveAlertSettings()">
                            <i class="fas fa-save"></i> Guardar Configuración
                        </button>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings-section" class="section-content">
                    <h1 class="page-title">Configuración de Seguridad</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Configuración General</h3>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Modo de Seguridad</label>
                            <select class="form-control" id="security-mode">
                                <option value="standard">Estándar</option>
                                <option value="high">Alto</option>
                                <option value="paranoid">Paranoico</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Política de Contraseñas</label>
                            <select class="form-control" id="password-policy">
                                <option value="low">Baja (8 caracteres)</option>
                                <option value="medium">Media (12 caracteres, números y símbolos)</option>
                                <option value="high">Alta (16 caracteres, mayúsculas, minúsculas, números y símbolos)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Expiración de Sesión (minutos)</label>
                            <input type="number" class="form-control" id="session-expiration" value="60">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Intentos Máximos de Acceso</label>
                            <input type="number" class="form-control" id="max-login-attempts" value="5">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="enable-two-factor" checked>
                                Habilitar Autenticación de Dos Factores
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="enable-ip-whitelist" checked>
                                Habilitar Lista Blanca de IPs
                            </label>
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveSecuritySettings()">
                            <i class="fas fa-save"></i> Guardar Configuración
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Configuración de Copias de Seguridad</h3>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Frecuencia de Copia de Seguridad</label>
                            <select class="form-control" id="backup-frequency">
                                <option value="daily">Diaria</option>
                                <option value="weekly">Semanal</option>
                                <option value="monthly">Mensual</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Ubicación de Copia de Seguridad</label>
                            <input type="text" class="form-control" id="backup-location" value="/var/backups/virtualmin-security">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Retención de Copias de Seguridad (días)</label>
                            <input type="number" class="form-control" id="backup-retention" value="30">
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveBackupSettings()">
                            <i class="fas fa-save"></i> Guardar Configuración
                        </button>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Add Rule Modal -->
    <div id="add-rule-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Añadir Regla de Firewall</h3>
                <button class="modal-close" onclick="closeModal('add-rule-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Nombre de la Regla</label>
                    <input type="text" class="form-control" id="rule-name">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Acción</label>
                    <select class="form-control" id="rule-action">
                        <option value="ACCEPT">Aceptar</option>
                        <option value="DROP">Descartar</option>
                        <option value="REJECT">Rechazar</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Protocolo</label>
                    <select class="form-control" id="rule-protocol">
                        <option value="TCP">TCP</option>
                        <option value="UDP">UDP</option>
                        <option value="ICMP">ICMP</option>
                        <option value="ANY">Cualquiera</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Puerto</label>
                    <input type="text" class="form-control" id="rule-port">
                </div>
                
                <div class="form-group">
                    <label class="form-label">IP Origen</label>
                    <input type="text" class="form-control" id="rule-source-ip" placeholder="Ej: 192.168.1.0/24">
                </div>
                
                <div class="form-group">
                    <label class="form-label">IP Destino</label>
                    <input type="text" class="form-control" id="rule-destination-ip" placeholder="Ej: ANY">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('add-rule-modal')">Cancelar</button>
                <button class="btn btn-primary" onclick="addFirewallRule()">Añadir Regla</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Global variables
        let currentSection = 'overview';
        let firewallChart = null;
        let wafChart = null;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            setupEventListeners();
            loadSecurityData();
        });

        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        // Show section
        function showSection(section) {
            // Hide all sections
            const sections = document.querySelectorAll('.section-content');
            sections.forEach(sec => sec.classList.remove('active'));
            
            // Remove active class from all menu items
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            // Show selected section
            document.getElementById(`${section}-section`).classList.add('active');
            
            // Add active class to selected menu item
            document.querySelector(`a[href="#${section}"]`).classList.add('active');
            
            // Update current section
            currentSection = section;
        }

        // Show tab
        function showTab(tabId) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tab items
            const tabItems = document.querySelectorAll('.tab-item');
            tabItems.forEach(item => item.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to selected tab item
            event.target.classList.add('active');
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Initialize charts
        function initializeCharts() {
            // Firewall Chart
            const firewallCtx = document.getElementById('firewall-chart');
            if (firewallCtx) {
                firewallChart = new Chart(firewallCtx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                        datasets: [{
                            label: 'Conexiones Permitidas',
                            data: [120, 132, 125, 145, 162, 155],
                            borderColor: 'rgba(39, 174, 96, 1)',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'Conexiones Bloqueadas',
                            data: [12, 19, 15, 25, 22, 30],
                            borderColor: 'rgba(231, 76, 60, 1)',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Estadísticas del Firewall (Últimas 24 horas)'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // WAF Chart
            const wafCtx = document.getElementById('waf-chart');
            if (wafCtx) {
                wafChart = new Chart(wafCtx, {
                    type: 'bar',
                    data: {
                        labels: ['SQL Inyección', 'XSS', 'RFI', 'LFI', 'CSRF', 'Otros'],
                        datasets: [{
                            label: 'Ataques Bloqueados',
                            data: [15, 22, 8, 5, 12, 7],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(243, 156, 18, 0.8)',
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(243, 156, 18, 0.8)',
                                'rgba(52, 152, 219, 0.8)'
                            ],
                            borderColor: [
                                'rgba(231, 76, 60, 1)',
                                'rgba(243, 156, 18, 1)',
                                'rgba(231, 76, 60, 1)',
                                'rgba(231, 76, 60, 1)',
                                'rgba(243, 156, 18, 1)',
                                'rgba(52, 152, 219, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Ataques Bloqueados por Tipo (Últimas 24 horas)'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Firewall toggle
            const firewallToggle = document.getElementById('firewall-toggle');
            if (firewallToggle) {
                firewallToggle.addEventListener('change', function() {
                    const status = this.checked ? 'activado' : 'desactivado';
                    showNotification(`Firewall ${status}`, this.checked ? 'success' : 'warning');
                });
            }
            
            // IDS/IPS toggle
            const idsToggle = document.getElementById('ids-toggle');
            if (idsToggle) {
                idsToggle.addEventListener('change', function() {
                    const status = this.checked ? 'activado' : 'desactivado';
                    showNotification(`IDS/IPS ${status}`, this.checked ? 'success' : 'warning');
                });
            }
            
            // WAF toggle
            const wafToggle = document.getElementById('waf-toggle');
            if (wafToggle) {
                wafToggle.addEventListener('change', function() {
                    const status = this.checked ? 'activado' : 'desactivado';
                    showNotification(`WAF ${status}`, this.checked ? 'success' : 'warning');
                });
            }
        }

        // Load security data
        function loadSecurityData() {
            // Simulate loading data
            setTimeout(function() {
                // Update notification badge
                const badge = document.querySelector('.notification-badge');
                if (badge) {
                    badge.textContent = '3';
                }
            }, 1000);
        }

        // Security functions
        function refreshComponents() {
            showNotification('Componentes de seguridad actualizados', 'success');
            // Simulate refreshing data
            setTimeout(function() {
                location.reload();
            }, 1000);
        }

        function showAddRuleModal() {
            showModal('add-rule-modal');
        }

        function addFirewallRule() {
            const ruleName = document.getElementById('rule-name').value;
            const ruleAction = document.getElementById('rule-action').value;
            const ruleProtocol = document.getElementById('rule-protocol').value;
            const rulePort = document.getElementById('rule-port').value;
            const ruleSourceIp = document.getElementById('rule-source-ip').value;
            const ruleDestinationIp = document.getElementById('rule-destination-ip').value;
            
            if (!ruleName || !rulePort) {
                showNotification('Por favor, complete todos los campos requeridos', 'error');
                return;
            }
            
            // Simulate adding rule
            showNotification(`Regla "${ruleName}" añadida correctamente`, 'success');
            closeModal('add-rule-modal');
            
            // In a real implementation, you would send this data to the server
            console.log({
                name: ruleName,
                action: ruleAction,
                protocol: ruleProtocol,
                port: rulePort,
                sourceIp: ruleSourceIp,
                destinationIp: ruleDestinationIp
            });
        }

        function importRules() {
            showNotification('Función de importación de reglas', 'info');
            // In a real implementation, you would show a file picker
        }

        function exportRules() {
            showNotification('Reglas de firewall exportadas', 'success');
            // In a real implementation, you would generate and download a file
        }

        function updateSignatures() {
            showNotification('Actualizando firmas IDS/IPS...', 'info');
            // Simulate update
            setTimeout(function() {
                showNotification('Firmas IDS/IPS actualizadas correctamente', 'success');
            }, 2000);
        }

        function addSignature() {
            showNotification('Función de añadir firma', 'info');
            // In a real implementation, you would show a form
        }

        function addRule() {
            showNotification('Función de añadir regla', 'info');
            // In a real implementation, you would show a form
        }

        function exportEvents() {
            showNotification('Eventos IDS/IPS exportados', 'success');
            // In a real implementation, you would generate and download a file
        }

        function renewCertificate(domain) {
            showNotification(`Renovando certificado para ${domain}...`, 'info');
            // Simulate renewal
            setTimeout(function() {
                showNotification(`Certificado para ${domain} renovado correctamente`, 'success');
                location.reload();
            }, 3000);
        }

        function viewCertificate(domain) {
            showNotification(`Ver detalles del certificado para ${domain}`, 'info');
            // In a real implementation, you would show certificate details
        }

        function requestCertificate() {
            showNotification('Función de solicitud de certificado', 'info');
            // In a real implementation, you would show a form
        }

        function configureAutoRenewal() {
            showNotification('Función de configuración de auto-renovación', 'info');
            // In a real implementation, you would show a form
        }

        function updateWafRules() {
            showNotification('Actualizando reglas WAF...', 'info');
            // Simulate update
            setTimeout(function() {
                showNotification('Reglas WAF actualizadas correctamente', 'success');
            }, 2000);
        }

        function addWafRule() {
            showNotification('Función de añadir regla WAF', 'info');
            // In a real implementation, you would show a form
        }

        function refreshLogs() {
            const logLevel = document.getElementById('log-level').value;
            showNotification(`Actualizando logs (${logLevel})...`, 'info');
            // Simulate refresh
            setTimeout(function() {
                showNotification('Logs actualizados correctamente', 'success');
            }, 1000);
        }

        function exportLogs() {
            showNotification('Logs de seguridad exportados', 'success');
            // In a real implementation, you would generate and download a file
        }

        function clearLogs() {
            if (confirm('¿Está seguro de que desea limpiar todos los logs de seguridad?')) {
                showNotification('Logs de seguridad limpiados', 'success');
                document.getElementById('log-viewer').innerHTML = '';
            }
        }

        function refreshAlerts() {
            showNotification('Actualizando alertas...', 'info');
            // Simulate refresh
            setTimeout(function() {
                showNotification('Alertas actualizadas correctamente', 'success');
                location.reload();
            }, 1000);
        }

        function resolveAlert(alertId) {
            showNotification(`Alerta ${alertId} resuelta`, 'success');
            // In a real implementation, you would send this data to the server
        }

        function saveAlertSettings() {
            const notificationMethod = document.getElementById('notification-method').value;
            const notificationRecipient = document.getElementById('notification-recipient').value;
            const alertLevel = document.getElementById('alert-level').value;
            
            if (!notificationRecipient) {
                showNotification('Por favor, complete todos los campos requeridos', 'error');
                return;
            }
            
            showNotification('Configuración de alertas guardada correctamente', 'success');
            // In a real implementation, you would send this data to the server
            console.log({
                notificationMethod,
                notificationRecipient,
                alertLevel
            });
        }

        function saveSecuritySettings() {
            const securityMode = document.getElementById('security-mode').value;
            const passwordPolicy = document.getElementById('password-policy').value;
            const sessionExpiration = document.getElementById('session-expiration').value;
            const maxLoginAttempts = document.getElementById('max-login-attempts').value;
            const enableTwoFactor = document.getElementById('enable-two-factor').checked;
            const enableIpWhitelist = document.getElementById('enable-ip-whitelist').checked;
            
            showNotification('Configuración de seguridad guardada correctamente', 'success');
            // In a real implementation, you would send this data to the server
            console.log({
                securityMode,
                passwordPolicy,
                sessionExpiration,
                maxLoginAttempts,
                enableTwoFactor,
                enableIpWhitelist
            });
        }

        function saveBackupSettings() {
            const backupFrequency = document.getElementById('backup-frequency').value;
            const backupLocation = document.getElementById('backup-location').value;
            const backupRetention = document.getElementById('backup-retention').value;
            
            if (!backupLocation) {
                showNotification('Por favor, complete todos los campos requeridos', 'error');
                return;
            }
            
            showNotification('Configuración de copias de seguridad guardada correctamente', 'success');
            // In a real implementation, you would send this data to the server
            console.log({
                backupFrequency,
                backupLocation,
                backupRetention
            });
        }

        function refreshCertificates() {
            showNotification('Actualizando certificados...', 'info');
            // Simulate refresh
            setTimeout(function() {
                showNotification('Certificados actualizados correctamente', 'success');
                location.reload();
            }, 2000);
        }

        // Utility functions
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert alert-${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.maxWidth = '300px';
            
            // Add icon based on type
            let icon = '';
            switch (type) {
                case 'success':
                    icon = '<i class="fas fa-check-circle"></i>';
                    break;
                case 'warning':
                    icon = '<i class="fas fa-exclamation-triangle"></i>';
                    break;
                case 'error':
                    icon = '<i class="fas fa-times-circle"></i>';
                    break;
                default:
                    icon = '<i class="fas fa-info-circle"></i>';
            }
            
            notification.innerHTML = `${icon} ${message}`;
            
            // Add to document
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(function() {
                document.body.removeChild(notification);
            }, 3000);
        }
    </script>
</body>
</html>